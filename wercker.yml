box: hseeberger/scala-sbt
build:
  steps:
    - script:
        name: install git
        code: |
          apt-get update && apt-get install git
    - script:
        name: run tests and publish if needed
        code: |
          sbt coverage test
deploy:
  steps:
    - script:
      name: publish artifacts
      code: |
        export PGP_SECRET_RING_PATH=$(mktemp -d)/secring.gpg
        echo "${PGP_SECRET}" | base64 --decode > "${PGP_SECRET_RING_PATH}"
        if [[ "${WERCKER_GIT_BRANCH}" == "master" ]]; then
          echo "${PGP_PASS}" | sbt publish-signed
        else :
        fi
